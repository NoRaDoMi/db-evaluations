# Sysbench Yuga- 3 nodes
- [Sysbench Yuga- 3 nodes](#sysbench-yuga--3-nodes)
- [1. Model deployment](#1-model-deployment)
    - [1.1 OS configuration](#11-os-configuration)
    - [1.2 Hardware configuration](#12-hardware-configuration)
    - [1.3 Versions](#13-versions)
  - [2. Test results](#2-test-results)
    - [2.1 oltp_read_only](#21-oltp_read_only)
    - [2.2 oltp_write_only](#22-oltp_write_only)
    - [2.3 oltp_read_write](#23-oltp_read_write)
    - [2.4 oltp_point_select](#24-oltp_point_select)
    - [2.5 oltp_insert](#25-oltp_insert)
    - [2.6 oltp_update_index](#26-oltp_update_index)
    - [2.7 oltp_update_non_index](#27-oltp_update_non_index)
    - [2.8 oltp_delete](#28-oltp_delete)

See detail test plan [here](../plan_test.md)

# 1. Model deployment

<div align="center">
 <img src="../../images/model-deploy-yb.png">
</div>

### 1.1 OS configuration

| **Linux OS platform** | **Version** |
|-----------------------|-------------|
| CentOS Linux          | 7.7.1908    |

### 1.2 Hardware configuration

| **Component**     | **Node**       | **CPU**  | **Mem** | **Disk** |
|-------------------|----------------|----------|---------|----------|
| yb-master         | 10.60.41.53-55  | 32 cores | 64GB    | SSD      |
| yb-tserver        | 10.60.41.53-55  | 32 cores | 64GB    | SSD      |
| HA Proxy          | 10.20.11.10    |          |         |          |
| Instance Sysbench | 10.20.11.57-58 | 64 cores | 64GB    | HDD      |

### 1.3 Versions

| **Application** | **Version**                               |
|-----------------|-------------------------------------------|
| YugabyteDB      | 2.1.6.0                                   |
| Sysbench        | 1.0.20 (using bundled LuaJIT 2.1.0-beta2) |

## 2. Test results

### 2.1 oltp_read_only

-   time = **1800s = 30 minutes**

-   report-interval = **10s**

-   number of tables = **1**

-   table size = **30000000**

**a. Read only with range selects**

| **Type**  | **Instance sysbench**     | **Thread** | **TPS** | **QPS** | **avg.latency(ms)** | **.99.latency(ms)** | **max.latency(ms)** | **start_bench**     | **end_bench**       |
|-----------|---------------------------|------------|---------|---------|---------------------|---------------------|---------------------|---------------------|---------------------|
| read_only | 10.20.11.57               | 1\*8       | 0.07    | 1.12    | 114140.59           | 100000.00           | 116545.50           | 29-06-2020 00:05:53 | 29-06-2020 00:36:23 |
| read_only | 10.20.11.57               | 1\*16      | 0.13    | 2.03    | 123176.50           | 100000.00           | 143051.86           | 29-06-2020 00:36:38 | 29-06-2020 01:08:29 |
| read_only | 10.20.11.57               | 1\*32      | 0.18    | 2.86    | 174004.98           | 100000.00           | 222222.51           | 29-06-2020 01:08:44 | 29-06-2020 01:40:56 |
| read_only | 10.20.11.57               | 1\*64      | 0.20    | 3.22    | 304712.25           | 100000.00           | 485363.93           | 29-06-2020 01:41:11 | 29-06-2020 02:14:07 |
| read_only | 10.20.11.57,  10.60.45.58 | 2\*64      | 0.04    | 0.51    | 3528758.535         | 100000.00           | 1764379.2675        | 29-06-2020 18:26:48 | 29-06-2020 19:33:48 |

**b. Read only without range selects (time=1200s=20 minutes)**

| **Type**  | **Instance sysbench**    | **Thread** | **TPS** | **QPS**  | **avg.latency(ms)** | **.99.latency(ms)** | **max.latency(ms)** | **start_bench**     | **end_bench**       |
|-----------|--------------------------|------------|---------|----------|---------------------|---------------------|---------------------|---------------------|---------------------|
| read_only | 10.20.11.57              | 1\*8       | 238.82  | 2965.84  | 33.49               | 42.61               | 84.41               | 30-06-2020 09:50:47 | 30-06-2020 10:10:48 |
| read_only | 10.20.11.57              | 1\*16      | 519.16  | 6229.92  | 30.81               | 40.37               | 96.23               | 30-06-2020 10:11:03 | 30-06-2020 10:31:03 |
| read_only | 10.20.11.57              | 1\*32      | 1118.67 | 13424.10 | 28.60               | 35.59               | 91.87               | 30-06-2020 10:31:18 | 30-06-2020 10:51:18 |
| read_only | 10.20.11.57              | 1\*64      | 2301.47 | 27617.61 | 27.80               | 38.25               | 138.57              | 30-06-2020 10:51:33 | 30-06-2020 11:11:34 |
| read_only | 10.20.11.57, 10.20.11.58 | 2\*64      | 6443.03 | 77316.42 | 19.865              | 40.82               | 186.91              | 30-06-2020 19:54:59 | 30-06-2020 19:54:59 |

### 2.2 oltp_write_only

-   time = **1800s=30 minutes**

-   report-interval = **10s**

-   number of tables = **1**

-   table size = **30000000**

**a. Write only with update_indexes and update_non_indexes**

| **Type**   | **Instance sysbench**    | **Thread** | **TPS** | **QPS**  | **avg.latency(ms)** | **.99.latency(ms)** | **max.latency(ms)** | **start_bench**     | **end_bench**       |
|------------|--------------------------|------------|---------|----------|---------------------|---------------------|---------------------|---------------------|---------------------|
| write_only | 10.20.11.57              | 1\*8       | 439.25  | 2635.51  | 18.21               | 27.17               | 2046.25             | 29-06-2020 09:23:51 | 29-06-2020 09:53:51 |
| write_only | 10.20.11.57              | 1\*16      | 953.34  | 5720.07  | 16.78               | 24.83               | 2381.64             | 29-06-2020 09:54:06 | 29-06-2020 10:24:06 |
| write_only | 10.20.11.57              | 1\*32      | 1850.40 | 11102.43 | 17.29               | 24.83               | 2153.90             | 29-06-2020 10:24:21 | 29-06-2020 10:54:22 |
| write_only | 10.20.11.57              | 1\*64      | 2749.57 | 16497.44 | 23.27               | 53.85               | 2124.33             | 29-06-2020 10:54:37 | 29-06-2020 11:24:37 |
| write_only | 10.20.11.57, 10.20.11.58 | 2\*64      | 4013.54 | 24081.23 | 31.89               | 37.225              | 2127.48             | 29-06-2020 19:35:30 | 29-06-2020 20:05:31 |

**b. Write only with only delete_insert (time=1200s=20 minutes)**

| **Type**   | **Instance sysbench**    | **Thread** | **TPS** | **QPS**  | **avg.latency(ms)** | **.99.latency(ms)** | **max.latency(ms)** | **start_bench**     | **end_bench**       |
|------------|--------------------------|------------|---------|----------|---------------------|---------------------|---------------------|---------------------|---------------------|
| write_only | 10.20.11.57              | 1\*8       | 385.67  | 1542.68  | 20.74               | 31.94               | 948.97              | 30-06-2020 11:11:49 | 30-06-2020 11:31:49 |
| write_only | 10.20.11.57              | 1\*16      | 1154.25 | 4617.00  | 13.86               | 28.67               | 1804.35             | 30-06-2020 11:32:04 | 30-06-2020 11:52:04 |
| write_only | 10.20.11.57              | 1\*32      | 2635.24 | 10540.94 | 12.14               | 18.28               | 2028.51             | 30-06-2020 11:52:19 | 30-06-2020 12:12:20 |
| write_only | 10.20.11.57              | 1\*64      | 3990.12 | 15960.50 | 16.04               | 24.83               | 2049.52             | 30-06-2020 12:12:35 | 30-06-2020 12:32:35 |
| write_only | 10.20.11.57, 10.20.11.58 | 2\*64      | 6740.24 | 26960.96 | 18.99               | 27.91               | 3178.725            | 30-06-2020 20:30:30 | 30-06-2020 20:50:31 |

### 2.3 oltp_read_write

-   time = **1800s=30 minutes**

-   report-interval = **10s**

-   number of tables = **1**

-   table size = **30000000**

| **Type**   | **Instance sysbench**    | **Thread** | **TPS** | **QPS** | **avg.latency(ms)** | **.99.latency(ms)** | **max.latency(ms)** | **start_bench**     | **end_bench**       |
|------------|--------------------------|------------|---------|---------|---------------------|---------------------|---------------------|---------------------|---------------------|
| read_write | 10.20.11.57              | 1\*8       | 0.01    | 0.29    | 572043.04           | 100000.00           | 640513.79           | 29-06-2020 11:24:52 | 29-06-2020 12:04:12 |
| read_write | 10.20.11.57              | 1\*16      | 0.02    | 0.45    | 616597.96           | 100000.00           | 703351.14           | 29-06-2020 12:04:27 | 29-06-2020 12:43:40 |
| read_write | 10.20.11.57              | 1\*32      | 0.04    | 0.75    | 810560.27           | 100000.00           | 981837.35           | 29-06-2020 12:43:55 | 29-06-2020 13:26:09 |
| read_write | 10.20.11.57              | 1\*64      | 0.04    | 0.88    | 1366708.93          | 100000.00           | 1791984.17          | 29-06-2020 13:26:25 | 29-06-2020 14:15:20 |
| read_write | 10.20.11.57, 10.20.11.58 | 2\*64      | 0.04    | 1.04    | 3616834.275         | 100000.00           | 4012448.57          | 29-06-2020 17:11:40 | 29-06-2020 18:18:26 |

### 2.4 oltp_point_select

-   time = **1200s=20 minutes**

-   report-interval = **10s**

-   number of tables = **1**

-   table size = **30000000**

| **Type**     | **Instance sysbench**    | **Thread** | **TPS**  | **QPS**  | **avg.latency(ms)** | **.99.latency(ms)** | **max.latency(ms)** | **start_bench**     | **end_bench**       |
|--------------|--------------------------|------------|----------|----------|---------------------|---------------------|---------------------|---------------------|---------------------|
| point_select | 10.20.11.57              | 1\*8       | 2032.66  | 2032.66  | 3.93                | 7.56                | 67.72               | 30-06-2020 12:38:51 | 30-06-2020 12:58:51 |
| point_select | 10.20.11.57              | 1\*16      | 4837.87  | 4837.37  | 3.30                | 6.32                | 48.94               | 30-06-2020 12:59:06 | 30-06-2020 13:19:07 |
| point_select | 10.20.11.57              | 1\*32      | 10952.41 | 10952.41 | 2.92                | 4.91                | 52.85               | 30-06-2020 13:19:22 | 30-06-2020 13:39:22 |
| point_select | 10.20.11.57              | 1\*64      | 23414.01 | 23414.01 | 2.73                | 4.65                | 77.79               | 30-06-2020 13:39:37 | 30-06-2020 13:59:37 |
| point_select | 10.20.11.57, 10.20.11.58 | 2\*64      | 34267.64 | 34267.64 | 1.865               | 5.05                | 137.015             | 30-06-2020 20:50:46 | 30-06-2020 21:10:47 |

### 2.5 oltp_insert

-   time = **1200s=20 minutes**

-   report-interval = **10s**

-   number of tables = **1**

-   table size = **30000000**

| **Type** | **Instance sysbench**    | **Thread** | **TPS**  | **QPS**  | **avg.latency(ms)** | **.99.latency(ms)** | **max.latency(ms)** | **start_bench**     | **end_bench**       |
|----------|--------------------------|------------|----------|----------|---------------------|---------------------|---------------------|---------------------|---------------------|
| insert   | 10.20.11.57              | 1\*8       | 3024.64  | 3024.64  | 2.64                | 3.82                | 84.10               | 30-06-2020 22:14:33 | 30-06-2020 22:34:34 |
| insert   | 10.20.11.57              | 1\*16      | 6536.13  | 6536.13  | 2.44                | 3.82                | 46.07               | 30-06-2020 22:34:52 | 30-06-2020 22:54:53 |
| insert   | 10.20.11.57              | 1\*32      | 11901.29 | 11901.29 | 2.69                | 4.74                | 88.01               | 30-06-2020 22:55:11 | 30-06-2020 23:15:12 |
| insert   | 10.20.11.57              | 1\*64      | 21869.33 | 21869.33 | 2.92                | 5.67                | 205.76              | 30-06-2020 23:15:31 | 30-06-2020 23:35:34 |
| insert   | 10.20.11.57, 10.20.11.58 | 2\*64      | 68535.28 | 68535.28 | 3.92                | 8.51                | 89.965              | 30-06-2020 23:38:39 | 01-07-2020 00:02:02 |

### 2.6 oltp_update_index

-   time = **1200s=20 minutes**

-   report-interval = **10s**

-   number of tables = **1**

-   table size = **30000000**

| **Type**     | **Instance sysbench**    | **Thread** | **TPS**  | **QPS**  | **avg.latency(ms)** | **.99.latency(ms)** | **max.latency(ms)** | **start_bench**     | **end_bench**       |
|--------------|--------------------------|------------|----------|----------|---------------------|---------------------|---------------------|---------------------|---------------------|
| update_index | 10.20.11.57              | 1\*8       | 1353.09  | 1353.09  | 5.91                | 11.04               | 603.73              | 30-06-2020 13:59:52 | 30-06-2020 14:19:53 |
| update_index | 10.20.11.57              | 1\*16      | 2617.98  | 2617.98  | 6.11                | 11.45               | 49.50               | 30-06-2020 14:20:08 | 30-06-2020 14:40:08 |
| update_index | 10.20.11.57              | 1\*32      | 9724.21  | 9724.21  | 3.29                | 8.43                | 53.19               | 30-06-2020 14:40:23 | 30-06-2020 15:00:23 |
| update_index | 10.20.11.57              | 1\*64      | 18368.66 | 18368.66 | 3.48                | 5.47                | 81.81               | 30-06-2020 15:00:38 | 30-06-2020 15:20:39 |
| update_index | 10.20.11.57, 10.20.11.58 | 2\*64      | 40735.7  | 40735.7  | 3.14                | 5.83                | 136.41              | 30-06-2020 21:11:02 | 30-06-2020 21:31:02 |

### 2.7 oltp_update_non_index

-   time = **1200s=20 minutes**

-   report-interval = **10s**

-   number of tables = **1**

-   table size = **30000000**

| **Type**         | **Instance sysbench**    | **Thread** | **TPS**  | **QPS**  | **avg.latency(ms)** | **.99.latency(ms)** | **max.latency(ms)** | **start_bench**     | **end_bench**       |
|------------------|--------------------------|------------|----------|----------|---------------------|---------------------|---------------------|---------------------|---------------------|
| update_non_index | 10.20.11.57              | 1\*8       | 1676.62  | 1676.62  | 4.77                | 8.28                | 112.84              | 30-06-2020 15:20:54 | 30-06-2020 15:40:54 |
| update_non_index | 10.20.11.57              | 1\*16      | 4361.84  | 4361.84  | 3.66                | 6.67                | 208.59              | 30-06-2020 15:41:09 | 30-06-2020 16:01:09 |
| update_non_index | 10.20.11.57              | 1\*32      | 11188.83 | 11188.83 | 2.86                | 4.65                | 80.65               | 30-06-2020 16:01:24 | 30-06-2020 16:21:25 |
| update_non_index | 10.20.11.57              | 1\*64      | 23499.17 | 23499.17 | 2.72                | 4.41                | 207.47              | 30-06-2020 16:21:40 | 30-06-2020 16:41:40 |
| update_non_index | 10.20.11.57, 10.20.11.58 | 2\*64      | 40580.61 | 40580.61 | 3.15                | 6.86                | 135.71              | 30-06-2020 21:31:17 | 30-06-2020 21:51:18 |

### 2.8 oltp_delete

-   time = **1200s=20 minutes**

-   report-interval = **10s**

-   number of tables = **1**

-   table size = **30000000**

| **Type** | **Instance sysbench**    | **Thread** | **TPS**  | **QPS**  | **avg.latency(ms)** | **.99.latency(ms)** | **max.latency(ms)** | **start_bench**     | **end_bench**       |
|----------|--------------------------|------------|----------|----------|---------------------|---------------------|---------------------|---------------------|---------------------|
| delete   | 10.20.11.57              | 1\*8       | 2138.91  | 2138.91  | 3.74                | 6.55                | 55.86               | 30-06-2020 16:41:55 | 30-06-2020 17:01:55 |
| delete   | 10.20.11.57              | 1\*16      | 5625.33  | 5625.33  | 2.84                | 7.98                | 65.12               | 30-06-2020 17:02:10 | 30-06-2020 17:22:11 |
| delete   | 10.20.11.57              | 1\*32      | 11210.69 | 11210.60 | 2.85                | 10.27               | 66.81               | 30-06-2020 17:22:26 | 30-06-2020 17:42:26 |
| delete   | 10.20.11.57              | 1\*64      | 19289.22 | 19289.22 | 3.31                | 15.00               | 148.18              | 30-06-2020 17:42:41 | 30-06-2020 18:02:41 |
| delete   | 10.20.11.57, 10.20.11.58 | 2\*64      | 42673.72 | 42673.72 | 2.995               | 6.85                | 138.975             | 30-06-2020 21:51:33 | 30-06-2020 22:11:34 |
